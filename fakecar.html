<html>
    <head></head>
    <body>
        Intensite:<span id="intensite"></span><br/>
        Tension:<span id="tension"></span><br/>
        Energie:<span id="energie"></span><br/>
        Latitude:<span id="lat"></span><br/>
        Longitude:<span id="lon"></span><br/>
        <button type="button" id="startsending">Envoyer les donn√©es</button>
    </body>
</html>
<script>
    var socket = new WebSocket("wss://emt.polytech-nancy.univ-lorraine.fr:8080/wsapi/?token=L2eEzMs7ZMpNJYCQaECg");
    socket.onopen = function () {

    };
    var lat = 43.77020;
    var lon = -0.04083;
    Lat=[43.770835,43.770595,43.770092,43.769611,43.769309,43.768960,43.768635,43.768240,43.767969,43.767744,43.767527,43.767527,43.767558,43.767651,43.767813,43.768100,43.768278,43.768549,43.768785,43.768898,43.768898,43.768720,43.768510,43.768326,43.768148,43.767899,43.767737,43.767613,43.767529,43.767459,43.767345,43.76227,43.767092,43.767038,43.766994,43.766930,43.766827,43.766633,43.766427,43.766249,43.766179,43.766276,43.766406,43.766579,43.766735,43.766876,43.767065,43.767205,43.767335,43.767675,43.768053,43.768442,43.768884,43.769219,43.769446,43.769916,43.770272,43.770639,43.771034,43.771336,43.771660,43.771995,43.772194,43.772335,43.772248,43.772103,43.771979,43.772043,43.772254,43.772545,43.772880,43.773231,43.773463,43.773658,43.773804,43.773966,43.773944,43.773777,43.773512,43.773350,43.773328,43.773199,43.772942,43.772815,43.772829,43.772826,43.772810,43.772740,43.772659,43.772516,43.772300,43.772086,43.771903,43.771684,43.771439,43.771223,43.771042];
    Long=[-0.039897,-0.039575,-0.038877,-0.038255,-0.037815,-0.037322,-0.036882,-0.036345,-0.035970,-0.035766,-0.035916,-0.036313,-0.036464,-0.036957,-0.037236,-0.037408,-0.037504,-0.037655,-0.037775,-0.037954,-0.038231,-0.038425,-0.038597,-0.038725,-0.038844,-0.038822,-0.038717,-0.038455,-0.038242,-0.037928,-0.037487,-0.037083,-0.036582,-0.036223,-0.035901,-0.035438,-0.035161,-0.035101,-0.035258,-0.035430,-0.035759,-0.036193,-0.036597,-0.037045,-0.037516,-0.037898,-0.038391,-0.038832,-0.039176,-0.039453,-0.039386,-0.039102,-0.039042,-0.039311,-0.039498,-0.039924,-0.040216,-0.040552,-0.040911,-0.041263,-0.041689,-0.042115,-0.042422,-0.042885,-0.043461,-0.043947,-0.044366,-0.044747,-0.045017,-0.045263,-0.045540,-0.045547,-0.045286,-0.044964,-0.044658,-0.044119,-0.043730,-0.043439,-0.043431,-0.043790,-0.044373,-0.044702,-0.044717,-0.044437,-0.043932,-0.043528,-0.043136,-0.042766,-0.042534,-0.042235,-0.041936,-0.041655,-0.041386,-0.041094,-0.040754,0.040451,-0.040190];
    document.getElementById("startsending").onclick = function () {
        socket.send(JSON.stringify({
            event:"debutrun"
        }))
        var i=0;
        var j=0;
        while (j<3*Lat.length) {
            task(i);
            if(i==Lat.length-1){
                i=0;
            }else{
                i++;
            }
            j++;
        }
        async function task(i) {
            await setTimeout(function () {
                lat=Lat[i];
                lon=Long[i];
                infos = {
                    event: "dataFromCar",
                    intensite: i / 10,
                    tension: i*10,
                    energie: i*100,
                    latt: lat,
                    long: lon,
                }
                document.getElementById("intensite").innerHTML = infos.intensite;
                document.getElementById("tension").innerHTML = infos.tension;
                document.getElementById("energie").innerHTML = infos.energie;
                document.getElementById("lat").innerHTML = infos.latt;
                document.getElementById("lon").innerHTML = infos.long;
                console.log(infos.long);
                socket.send(JSON.stringify(infos));
            },1000);
        }
    }
</script>